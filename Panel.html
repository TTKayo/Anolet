<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Owner Panel</title>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<style>
body {
  background-color: #0e0e23; /* Dark blue */
  color: #ffffff; /* White */
  font-family: 'Roboto', sans-serif; /* Google font */
}

.container {
  margin: 0 auto;
  padding: 20px;
  max-width: 600px;
  background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black */
  border-radius: 10px;
  animation: fadeIn 1s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

h1 {
  text-align: center;
  margin-bottom: 20px;
  color: #ffcd55; /* Yellow */
}

.form-group label {
  display: block;
  margin-bottom: 10px;
  color: #ffffff; /* White */
}

.form-group input, .form-group textarea {
  width: 100%;
  padding: 10px;
  background-color: rgba(255, 255, 255, 0.1); /* Semi-transparent white */
  border: none;
  border-radius: 5px;
  color: #ffffff; /* White */
  animation: slideIn 1s ease;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.form-group textarea {
  resize: vertical;
}

button {
  width: 100%;
  padding: 12px 20px;
  margin-top: 20px;
  background-color: #ffcd55; /* Yellow */
  color: #0e0e23; /* Dark blue */
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.3s ease;
  animation: fadeInButton 1s ease;
}

button:hover {
  background-color: #ffa600; /* Brighter yellow */
  transform: scale(1.05); /* Scale up slightly on hover */
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); /* Add shadow on hover */
}

@keyframes fadeInButton {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#userDataForm {
  display: none;
  animation: slideInForm 1s ease;
}

@keyframes slideInForm {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#alert {
  display: none;
  padding: 15px;
  margin: 10px 0;
  border-radius: 5px;
  color: #0e0e23; /* Dark blue */
  background-color: #76B041; /* Anole green */
}

</style>
</head>
<body>
<div class="container">
  <h1>Owner Panel</h1>
  <div id="alert"></div>
  <div class="form-group">
    <label for="username">Username</label>
    <input type="text" id="username" placeholder="Enter username">
  </div>
  <button onclick="loadUserData()">Load User Data</button>
  <div id="userDataForm" style="display: none;">
    <div class="form-group">
      <label for="ban">Ban (true/false)</label>
      <input type="text" id="ban">
    </div>
    <div class="form-group">
      <label for="banReason">Ban Reason</label>
      <input type="text" id="banReason">
    </div>
    <button onclick="updateUserData()">Update User Data</button>
  </div>
</div>

<script>
  // Initialize Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyCOIKlP9YhtX9xa5aoggmsrWwavlW-XuzI",
    authDomain: "cosmik-7c124.firebaseapp.com",
    databaseURL: "https://cosmik-7c124-default-rtdb.firebaseio.com",
    projectId: "cosmik-7c124",
    storageBucket: "cosmik-7c124.appspot.com",
    messagingSenderId: "412506429662",
    appId: "1:412506429662:web:9ca3e17199297df7384a4f",
    measurementId: "G-R7K0LTHCK3"
  };

  firebase.initializeApp(firebaseConfig);
  const firestore = firebase.firestore();

  // Function to get the value of a cookie by name
  function getCookie(name) {
    let cookies = document.cookie.split(';');
    for (let cookie of cookies) {
      let [key, value] = cookie.split('=');
      key = key.trim();
      if (key === name) {
        return decodeURIComponent(value);
      }
    }
    return null;
  }

  // Function to check if user roles include any of the specified roles
  function hasRequiredRole(roles, requiredRoles) {
    for (let role of roles) {
      if (requiredRoles.includes(role.trim())) {
        return true;
      }
    }
    return false;
  }

  // Check user roles and redirect if necessary
  function checkUserRole() {
    let rolesCookie = getCookie('roles');
    if (rolesCookie) {
      let userRoles = rolesCookie.split(',');
      let requiredRoles = ['Helper', 'Mod', 'Admin', 'Owner'];

      if (!hasRequiredRole(userRoles, requiredRoles)) {
        window.location.href = 'unauthorized.html'; // Redirect to unauthorized page
      }
    } else {
      window.location.href = 'unauthorized.html'; // Redirect to unauthorized page
    }
  }

  // Run the role check on page load
  checkUserRole();

  function showAlert(message, isError = false) {
    const alertDiv = document.getElementById('alert');
    alertDiv.style.display = 'block';
    alertDiv.textContent = message;
    alertDiv.style.backgroundColor = isError ? '#FF6347' : '#76B041'; // Tomato red for error, Anole green for success
  }

  function loadUserData() {
    const username = document.getElementById("username").value;
    if (!username) {
      showAlert('Please enter a username.', true);
      return;
    }

    firestore.collection("users").doc(username).get().then((doc) => {
      if (doc.exists) {
        const userData = doc.data();
        document.getElementById("ban").value = userData.ban;
        document.getElementById("banReason").value = userData.banReason;
        document.getElementById("userDataForm").style.display = 'block';
      } else {
        showAlert('User not found.', true);
      }
    }).catch((error) => {
      console.error("Error getting document:", error);
      showAlert('Error getting document: ' + error.message, true);
    });
  }

  function updateUserData() {
    const username = document.getElementById("username").value;
    const ban = document.getElementById("ban").value.toLowerCase() === 'true';
    const banReason = document.getElementById("banReason").value;

    firestore.collection("users").doc(username).update({
      ban: ban,
      banReason: banReason
    }).then(() => {
      showAlert('User data updated successfully.');
    }).catch((error) => {
      console.error("Error updating document: ", error);
      showAlert('Error updating document: ' + error.message, true);
    });
  }
</script>
</body>
</html>
